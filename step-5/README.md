# Step 5: Applying functions

Now that you have a game board and a set of 16 cards with proper images and alt text, it's time to add the functions that make the game work.

If you look inside your `static_site/script.js` file, you see that you had several [_global variables_](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_Types#variable_scope) that are defined at the top of the file, and are manipulated later in the code within different functions. In your `GameBoard.vue` component, define these same variables in the `data() { return {...} }` object. The syntax for this is new, but it will tell the Vue app that were are defining a set of variables that will be used and manipulated/updated throughout the component.

Add this code to the `export default {...}` object in your `GameBoard.vue` component:

```js
export default {
  components: {
    CardView,
  },
  data() {
    return {
      cardsData: cardData.concat(cardData),
      matchedPairs: 0,
      cardOne: "",
      cardTwo: "",
      disableDeck: false,
    };
  },
```

Now add a `methods: {}` object to your `export default {...}` object, like this:

```js
export default {
  components: {
    CardView,
  },
  data() {
    return {
      cardsData: cardData.concat(cardData),
      matchedPairs: 0,
      cardOne: "",
      cardTwo: "",
      disableDeck: false,
    };
  },
  methods: {},
};
```

Inside the `methods: {}` object, rebuild the `shuffleCards()` function from your original `../static_site/script.js` file by first adding the _scoped data variable_ resets (similar to the _global variable_ resets in the original code).
In VueJS however, since we are referencing _scoped_ variables, we need to reference _this component, itself_ when referring to the variables.
Use this code to start your `shuffleCards()` method:

```js
methods: {
  shuffleCards() {
    this.matchedPairs = 0; // reset matchedPairs variable to 0
    this.disableDeck = false; // reset disableDeck boolean
    this.cardOne = "";
    this.cardTwo = ""; // reset cardOne and cardTwo variables
  }
},
```

Next you will want to randomly sort the cards inside this function. In the original `script.js` file, your code had to find all the DOM elements, create a new array, sort the new array, then apply the sorted numbers to the DOM elements in a loop! That was a lot of code! In this project however, the card data is defined by an array of objects, and the `<li class="card">` tags are generated by looping through the `cardsData` array of objects. `cardsData` is a `data() {...}` property, which makes it [_reactive_](https://vuejs.org/guide/extras/reactivity-in-depth.html#what-is-reactivity).

This means that anytime we _change_ the value of `cardsData`, the whole `v-for` loop will _react_ and will apply the changes directly.
Add this function:

```js
this.cardsData = this.cardsData.sort(function () {
  return 0.5 - Math.random();
});
```

Inside the `shuffleCards() {...}` method, like this:

```js
shuffleCards() {
  this.matchedPairs = 0; // reset matchedPairs variable to 0
  this.disableDeck = false; // reset disableDeck boolean
  this.cardOne = "";
  this.cardTwo = ""; // reset cardOne and cardTwo variables
  this.cardsData = this.cardsData.sort(function () {
    return 0.5 - Math.random();
  });
},
```

Wow! Your original `shuffleCards()` function from the `script.js` file was about 12 lines of code, and had a [_time cost_](https://web.dev/why-speed-matters/#performance-is-about-user-experience) to compute and change DOM element values.
Your VueJS version is 9 lines of code and will execute MUCH faster. (You may not notice the speed difference, since as we learned previously, JavaScript can be very FAST on its own)

To see this in action, call the `shuffleCards()` method inside a [`mounted()` property](https://www.digitalocean.com/community/tutorials/vuejs-component-lifecycle#understanding-mounting-hooks-dom-insertion). `mounted()` is a [Vue Lifecycle Hook](https://vuejs.org/guide/essentials/lifecycle.html). It will only run whenever the current component (`GameBoard.vue`) mounts to the DOM. This is similar to a page refresh, except that it is a _component_ refresh.

Add this `mounted() {...}` code to your `export default {...}` object:

```js
data() {
    return {
      cardsData: cardData.concat(cardData),
      matchedPairs: 0,
      cardOne: "",
      cardTwo: "",
      disableDeck: false,
    };
  },
  mounted() {
    this.shuffleCards();
  },
  methods: {
    shuffleCards() {
```

Save this work and test it in your browser. Just like your original `static_site`, when you reload the page, the cards will be _shuffled_. (If you want to see this visually, add the `flip` class to the `<li class="card">` element again. Remove the class when you are done checking your work)

Next you will add the `flipCard` function.
Create the function in your `methods: {..}` object, like this:

```js
 methods: {
  shuffleCards() { ...
  },
  flipCard(evt) {
    const clickedCard = evt.target; // set the event's target DOM element as a variable
    if (this.cardOne !== clickedCard && !this.disableDeck) { // make sure that the current variable cardOne is not the same value as the clickedCard, AND that the deck is NOT disabled
      clickedCard.classList.add("flip"); // add the 'flip' class to the classes currently assigned to the clickedCard
      if (!this.cardOne) {
        // if there is not yet a value assigned to the cardOne variable...
        return (this.cardOne = clickedCard); // set the cardOne value as the clickedCard and end this function.
      }
      // everything below will execute if the condition above was not met (if cardOne already had a value when flipCard() was called)
      this.cardTwo = clickedCard; // set the cardTwo value as the clickedCard
      this.disableDeck = true; // set this to true for the next time this flipCard function is called, when the top level condition is evaluated
      // if the function has come this far, it means we have set values for both cardOne and cardTwo.
      // each of the cardOne and cardTwo variables currently represent a whole HTML element with childNodes
      let cardOneImg = this.cardOne.querySelector(".back-view img").src; // query the elements inside cardOne to get the value of the img src, such as `img-2.png`, and set that as the value of cardOneImg
      let cardTwoImg = this.cardTwo.querySelector(".back-view img").src; // query the elements inside cardOne to get the value of the img src, such as `img-2.png`, and set that as the value of cardTwoImg
      matchCards(cardOneImg, cardTwoImg); // now check the images by filename to see if they are a match!
    }
  },
},
```

Notice that the code above is almost an identical copy of the code from your `script.js` file, _*except*_ that any mention of a formerly-global variable has been update to be prefixed with `this.`. That's how the Vue app knows that the variables in question are scoped to _*this*_ component.

You may also see a syntax error under the `matchCards()` function call - that's because you have not yet defined that function!

Before you get to the `matchCards()` function, you will want to add the `flipCard` function as a click event callback. With Vue, this is easy...

In your `GameBoard.vue` component, find your `<li>` tag:

```html
<li v-for="(cardInfo, index) in cardsData" :key="index" class="card"></li>
```

Reformat this tag so that the attributes/props/directives all appear stacked:

```html
<li v-for="(cardInfo, index) in cardsData" :key="index" class="card"></li>
```

Then add a [_vue-bound click event handler_](https://v2.vuejs.org/v2/guide/events.html) on the line following the `class` attribute, like this:

```html
<li
  v-for="(cardInfo, index) in cardsData"
  :key="index"
  class="card"
  @click="flipCard"
></li>
```

Save this work and test the app in the browser. You should be able to _flip_ two cards on the game board, and then the functions will halt. Now you will need to implement the `matchCards` function.

Before moving on to the next step, see if you can copy the `matchCards` function from your original `script.js` file, and apply it in the `methods: {...}` object in your `GameBoard.vue` component. Remember that any variable or function that is defined inside the component must be referenced with the `this.` prefix.

When you are ready, go on to [Step 6](/step-6).
